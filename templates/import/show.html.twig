{% extends 'base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/import/show.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ asset('DataTables/datatables.css') }}">
    <link rel="stylesheet" href="{{ asset('select/css/select2.css') }}">
{% endblock %}



{% block title %}DOMMA - Import{% endblock %}

{% block body %}
    <main>
            <div class="separator import-title">
                <h1>{{ import.fileName }}</h1>
                <div class="hover-message-container">
                    <a href="{{ path('context_show', {'id': context.id}) }}">
                        <i class="fas fa-backward icons-main"></i>
                    </a>
                    <span class="hover-message-text">Revenir à la page des contextes</span>
                </div>
            </div>

        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert-{{ label }} alert-margin-left">{{ message }}</div>
            {% endfor %}
        {% endfor %}

        <div class="macros-select-container">
            <div>
                {{ form_start(macroForm) }}
                    {{ form_widget(macroForm) }}
                    <input type="submit" name="details" id="macro-details" class="macros-select-submit" value="Voir en détail">
                    <input type="submit" name="apply" id="macro-apply" class="macros-select-submit" value="Appliquer macro">
                {{ form_end(macroForm) }}
            </div>
            <a href="{{ path('macro_new') }}" id="button-new-macro">Macro <i class="fa fa-plus icon-plus-macro"></i></a>
        </div>

        <div class="macros-select-container">
            <div>
                {{ form_start(columnsForm) }}
                    {{ form_widget(columnsForm) }}
                    <input type="submit" name="delete-columns" class="macros-select-submit column-delete" value="Supprimer colonnes">
                {{ form_end(columnsForm) }}
            </div>
            <div class="export-file-container">
                {{ form_start(exportForm) }}
                    {{ form_widget(exportForm) }}
                    <button>
                        <i class="fas fa-file-download icons-main icon-download"></i>
                    </button>
                {{ form_end(exportForm) }}
            </div>
        </div>

        <div class="file-container">
            {% if (import.status == 'En attente') or (import.status == 'En cours') %}
                <p><i class="fas fa-spinner fa-2x icon-loading"></i>En cours de chargement...</p>
            {% else %}
                <table class="import-table display" id="file-table">
                    <thead>
                        <tr>
                            {% for importColumn in importColumns %}
                                <th>{{ importColumn }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            {% for importObjet in importContent %}
                                {% for importValue in importObjet %}
                                    <td>{{ importValue }}</td>
                                {% endfor %}
                        </tr>
                            {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
        </div>
    </main>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('javascript/jquery-3.4.1.min.js') }}"></script>
    <script src="{{ asset('javascript/select_apply.js') }}"></script>
    <script src="{{ asset('select/js/select2.js') }}"></script>
    <script src="{{ asset('select/js/fr.js') }}"></script>
    <script type="text/javascript" charset="utf8" src="{{ asset('DataTables/datatables.js') }}"></script>
    <script type="text/javascript" charset="utf8" src="{{ asset('javascript/show_import.js') }}"></script>
{% endblock %}

